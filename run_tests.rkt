#lang racket
(require "interpreter/interpreter.rkt")
(require "interpreter/functionParser.rkt")
(require "interpreter/env.rkt")
(require "interpreter/mstate-mvalue.rkt")
(require "interpreter/mstate-outer.rkt")

(define error_test_case
    (lambda (result expected)
        (newline)
        (display "error test case")
        (newline)
        (with-handlers ((exn:fail? (lambda (e) (display e)))) (result))
        (newline)
        (display " = ")
        (newline)
        (with-handlers ((exn:fail? (lambda (e) (display e)))) (expected))
        (newline)
        (newline)
    )
)

(define test_case
  (lambda (result expected)
    ;; <<result == expected>> <= <<result>> = <<expected>>\n
    (display (equal? result expected)) (display " <= ") (display result) (display " = ") (display expected) (newline)
  )
)

(newline)

(error_test_case (lambda () (interpret "test_cases/test11" "A")) (lambda () (assign-error 'y)))
(error_test_case (lambda () (interpret "test_cases/test12" "A")) (lambda () (undeclared-error 'x)))
(error_test_case (lambda () (interpret "test_cases/test13" "A")) (lambda () (undefined-error 'x)))
(error_test_case (lambda () (interpret "test_cases/test14" "A")) (lambda () (double-declare-error 'x)))
;(error_test_case (lambda () (interpret "test_cases/test22")) (lambda () (multiple-returns-error)))
(error_test_case (lambda () (interpret "test_cases/test23" "A")) (lambda () (boolean-mismatch-error 5)))
(error_test_case (lambda () (interpret "test_cases/test24" "A")) (lambda () (boolean-mismatch-error 10)))
(error_test_case (lambda () (interpret "test_cases/test25" "A")) (lambda () (undefined-error 'return)))
;; TODO: fix these once you start testing
(error_test_case (lambda () (interpret "test_cases/test30" "A")) (lambda () (undeclared-error 'min)));
(error_test_case (lambda () (interpret "test_cases/test36" "A")) (lambda () (undeclared-error 'y)))
(error_test_case (lambda () (interpret "test_cases/test37" "A")) (lambda () (undeclared-error 'a)))
(error_test_case (lambda () (interpret "test_cases/test38" "A")) (lambda () (break-error 'todo)))
(error_test_case (lambda () (interpret "test_cases/test44" "A")) (lambda () (throw-error 'todo)))
(error_test_case (lambda () (interpret "test_cases/test64" "A")) (lambda () (name-value-length-error '(a) '(10 11 12))))
(error_test_case (lambda () (interpret "test_cases/test69" "A")) (lambda () (assign-error 'b)))


(test_case (interpret "test_cases/test1" "A")
           150)
(test_case (interpret "test_cases/test2" "A")
           -4)
(test_case (interpret "test_cases/test3" "A")
           10)
(test_case (interpret "test_cases/test4" "A")
           16)
(test_case (interpret "test_cases/test5" "A")
           220)
(test_case (interpret "test_cases/test6" "A")
           5)
(test_case (interpret "test_cases/test7" "A")
           6)
(test_case (interpret "test_cases/test8" "A")
           10)
(test_case (interpret "test_cases/test9" "A")
           5)
(test_case (interpret "test_cases/test10" "A")
           -39)
(test_case (interpret "test_cases/test15" "A")
           'true)
(test_case (interpret "test_cases/test16" "A")
           100)
(test_case (interpret "test_cases/test17" "A")
           'false)
(test_case (interpret "test_cases/test18" "A")
           'true)
(test_case (interpret "test_cases/test19" "A")
           128)
(test_case (interpret "test_cases/test20" "A")
           12)
(test_case (interpret "test_cases/test21" "A")
           100)
;;;; interpreter part 2
(test_case (interpret "test_cases/test26" "A")
           20)
(test_case (interpret "test_cases/test27" "A")
           164)
(test_case (interpret "test_cases/test28" "A")
           32)
(test_case (interpret "test_cases/test29" "A")
           2)
(test_case (interpret "test_cases/test31" "A")
           25)
(test_case (interpret "test_cases/test32" "A")
           21)
(test_case (interpret "test_cases/test33" "A")
           6)
(test_case (interpret "test_cases/test34" "A")
           -1)
(test_case (interpret "test_cases/test35" "A")
           789)
(test_case (interpret "test_cases/test39" "A")
           12)
(test_case (interpret "test_cases/test40" "A")
           125)
(test_case (interpret "test_cases/test41" "A")
           110)
(test_case (interpret "test_cases/test42" "A")
           2000400)
(test_case (interpret "test_cases/test43" "A")
           101)
(test_case (interpret "test_cases/test45" "A")
           12)
;;;; interpreter part 3
(test_case (interpret "test_cases/test53" "A")
           10)
(test_case (interpret "test_cases/test54" "A")
           14)
(test_case (interpret "test_cases/test55" "A")
           45)
(test_case (interpret "test_cases/test56" "A")
           55)
(test_case (interpret "test_cases/test57" "A")
           1)
(test_case (interpret "test_cases/test58" "A")
           115)
(test_case (interpret "test_cases/test59" "A")
           'true)
(test_case (interpret "test_cases/test60" "A")
           20)
(test_case (interpret "test_cases/test61" "A")
           24)
(test_case (interpret "test_cases/test62" "A")
           2)
(test_case (interpret "test_cases/test63" "A")
           35)
;(test_case (interpret "test_cases/test64") ) test 12 - mismatch params and args
(test_case (interpret "test_cases/test65" "A")
           90)
(test_case (interpret "test_cases/test66" "A")
           69)
(test_case (interpret "test_cases/test67" "A")
           87)
(test_case (interpret "test_cases/test68" "A")
           64)
;(test_case (interpret "test_cases/test69") ) test 17 - b not in scope
(test_case (interpret "test_cases/test70" "A")
           125)
(test_case (interpret "test_cases/test71" "A")
           100)
(test_case (interpret "test_cases/test72" "A")
           2000400)
(test_case (interpret "test_cases/test73" "A")
           'false)
(test_case (interpret "test_cases/test74" "A")
           'false)
(test_case (interpret "test_cases/test75" "A")
           120)
(test_case (interpret "test_cases/test76" "A")
           'true)
(test_case (interpret "test_cases/test77" "A")
           0)
(test_case (interpret "test_cases/test78" "A")
           34)
(test_case (interpret "test_cases/test79" "A")
           'true)
(test_case (interpret "test_cases/test81" "A")
           15)
(test_case (interpret "test_cases/test82" "A")
           12)
(test_case (interpret "test_cases/test83" "A")
           125)
(test_case (interpret "test_cases/test84" "A")
           36)
(test_case (interpret "test_cases/test85" "A")
           54)
(test_case (interpret "test_cases/test86" "A")
           110)
(test_case (interpret "test_cases/test87" "C")
           26)
(test_case (interpret "test_cases/test88" "Square")
           117)
(test_case (interpret "test_cases/test89" "Square")
           32)
(test_case (interpret "test_cases/test90" "List")
           15)
(test_case (interpret "test_cases/test91" "List")
           123456)
(test_case (interpret "test_cases/test92" "List")
           5285)
(test_case (interpret "test_cases/test93" "C")
           -716)
